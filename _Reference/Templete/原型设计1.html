import React, { useState, useEffect } from 'react';
import { 
  BookOpen, 
  Network, 
  Search, 
  LayoutGrid, 
  Settings, 
  Sparkles, 
  FileText, 
  Highlighter, 
  MessageSquare, 
  ChevronRight,
  Plus,
  Bell,
  User,
  ArrowUpRight,
  Database,
  DownloadCloud,
  X,
  Activity,
  Dna
} from 'lucide-react';

// --- Theme Config ---
const THEME = {
  primary: "text-emerald-700",
  primaryBg: "bg-emerald-600",
  primaryLight: "bg-emerald-50",
  accent: "text-teal-600",
  accentBg: "bg-teal-50",
  gradient: "from-emerald-500 to-teal-500",
};

// --- Mock Data ---

const RECENT_PAPERS = [
  { id: 1, title: "CRISPR-Cas9 Gene Editing Mechanisms", authors: "Doudna et al.", journal: "Science 2014", status: "Read", added: "2 hours ago" },
  { id: 2, title: "AlphaFold: Protein Structure Prediction", authors: "Jumper et al.", journal: "Nature 2021", status: "Reading", added: "5 hours ago" },
  { id: 3, title: "mRNA Vaccine Technology Overview", authors: "Karikó et al.", journal: "Immunity 2020", status: "New", added: "1 day ago" },
];

const STATS = [
  { label: "Total Papers", value: "1,284", unit: "Docs", trend: "+12%", icon: FileText, color: "text-emerald-600", bg: "bg-emerald-50" },
  { label: "Bio-Entities", value: "12.9k", unit: "Nodes", trend: "+5%", icon: Dna, color: "text-teal-600", bg: "bg-teal-50" },
  { label: "AI Insights", value: "840", unit: "Chats", trend: "+84", icon: Sparkles, color: "text-lime-600", bg: "bg-lime-50" },
];

// --- Dynamic Background Components ---

const OrganicBackground = ({ type }) => {
  if (type === 'dashboard') {
    return (
      <div className="absolute inset-0 overflow-hidden pointer-events-none z-0">
        {/* Cellular Matrix: Hexagons */}
        <div className="absolute top-[-10%] left-[-10%] w-[50%] h-[50%] opacity-20 animate-float-slow">
           <svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
             <path fill="#10b981" d="M44.7,-76.4C58.9,-69.2,71.8,-59.1,81.6,-46.6C91.4,-34.1,98.1,-19.2,95.8,-4.9C93.5,9.4,82.2,23.1,70.9,34.4C59.6,45.7,48.3,54.6,36.3,61.9C24.3,69.2,11.6,74.9,-1.9,78.2C-15.4,81.5,-30.5,82.4,-44.1,76.5C-57.7,70.6,-69.8,57.9,-78.6,43.5C-87.4,29.1,-92.9,13,-91.2,-2.4C-89.5,-17.8,-80.6,-32.5,-69.7,-44.6C-58.8,-56.7,-45.9,-66.2,-32.2,-73.7C-18.5,-81.2,-4,-86.7,10.2,-86.3L20.4,-85.9" transform="translate(100 100) scale(1.1)" />
           </svg>
        </div>
        
        <div className="absolute bottom-[-10%] right-[-5%] w-[40%] h-[40%] opacity-10 animate-float-reverse">
           <svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
             <path fill="#0d9488" d="M41.7,-65.4C53.5,-56.1,62.3,-43.3,68.9,-29.4C75.5,-15.5,79.9,-0.5,77.3,13.2C74.7,26.9,65.1,39.3,53.8,49.2C42.5,59.1,29.5,66.5,15.6,69.2C1.7,71.9,-13.1,69.9,-27.1,64.2C-41.1,58.5,-54.3,49.1,-63.9,37C-73.5,24.9,-79.5,10.1,-78.3,-4.2C-77.1,-18.5,-68.7,-32.3,-57.4,-42.9C-46.1,-53.5,-31.9,-60.9,-17.9,-63.8C-3.9,-66.7,9.1,-65.1,20.1,-61.5L29.9,-74.7" transform="translate(100 100)" />
           </svg>
        </div>

        {/* Floating Polygons */}
        <div className="absolute top-[20%] right-[20%] w-32 h-32 bg-emerald-100/30 rotate-12 rounded-3xl animate-pulse-slow backdrop-blur-3xl blur-2xl"></div>
        <div className="absolute top-[60%] left-[10%] w-48 h-48 bg-teal-100/30 -rotate-12 rounded-full animate-float blur-3xl"></div>
      </div>
    );
  }
  
  if (type === 'reader') {
    return (
      <div className="absolute inset-0 overflow-hidden pointer-events-none z-0">
        {/* Subtle Strand / DNA abstraction on the right */}
        <svg className="absolute right-0 top-0 h-full w-1/3 opacity-20" viewBox="0 0 100 400" preserveAspectRatio="none">
          <path d="M50 0 C 80 100, 20 200, 50 400" stroke="url(#grad1)" strokeWidth="2" fill="none" className="animate-dash" />
          <path d="M60 0 C 90 100, 30 200, 60 400" stroke="url(#grad1)" strokeWidth="2" fill="none" className="animate-dash" style={{animationDelay: '1s'}} />
          <defs>
            <linearGradient id="grad1" x1="0%" y1="0%" x2="0%" y2="100%">
              <stop offset="0%" style={{stopColor:'#10b981', stopOpacity:0}} />
              <stop offset="50%" style={{stopColor:'#10b981', stopOpacity:0.5}} />
              <stop offset="100%" style={{stopColor:'#10b981', stopOpacity:0}} />
            </linearGradient>
          </defs>
        </svg>
        <div className="absolute inset-0 bg-gradient-to-r from-white via-white/80 to-emerald-50/20"></div>
      </div>
    );
  }

  return null; // Graph handles its own background
};

// --- Components ---

const SidebarItem = ({ icon: Icon, active, onClick }) => (
  <button 
    onClick={onClick}
    className={`w-10 h-10 flex items-center justify-center rounded-xl transition-all duration-300 mb-4 group relative ${
      active 
        ? 'bg-gradient-to-br from-emerald-600 to-teal-700 text-white shadow-lg shadow-emerald-200' 
        : 'text-slate-400 hover:bg-emerald-50 hover:text-emerald-700'
    }`}
  >
    <Icon size={20} strokeWidth={2} />
    {!active && <div className="absolute right-2 top-2 w-1.5 h-1.5 bg-emerald-500 rounded-full opacity-0 group-hover:opacity-100 transition-opacity" />}
  </button>
);

const StatCard = ({ stat }) => (
  <div className="bg-white/80 backdrop-blur-sm p-6 rounded-2xl border border-emerald-100/50 shadow-sm hover:shadow-lg hover:shadow-emerald-100/50 transition-all duration-300 flex flex-col justify-between h-40 group">
    <div className="flex justify-between items-start">
      <div className={`p-3 rounded-xl transition-colors ${stat.bg} ${stat.color} group-hover:scale-110 duration-300`}>
        <stat.icon size={20} />
      </div>
      <span className="text-xs font-medium px-2 py-1 rounded-full bg-white text-emerald-600 border border-emerald-100 shadow-sm">
        {stat.trend}
      </span>
    </div>
    <div>
      <h3 className="text-3xl font-bold text-slate-800 tracking-tight">{stat.value}</h3>
      <p className="text-sm text-slate-500 font-medium mt-1">{stat.label}</p>
    </div>
  </div>
);

const WelcomeScreen = ({ onStart }) => (
  <div className="fixed inset-0 bg-white z-50 flex flex-col items-center justify-center animate-fade-in overflow-hidden">
    {/* Welcome Background */}
    <div className="absolute inset-0 pointer-events-none">
       <div className="absolute top-[-20%] left-[-10%] w-[60vw] h-[60vw] bg-emerald-100/40 rounded-full blur-[100px] animate-pulse-slow"></div>
       <div className="absolute bottom-[-10%] right-[-10%] w-[50vw] h-[50vw] bg-teal-100/40 rounded-full blur-[100px] animate-pulse-slow" style={{animationDelay: '2s'}}></div>
    </div>

    <div className="w-full max-w-4xl px-8 flex flex-col items-center text-center relative z-10">
      <div className="mb-8 relative group cursor-pointer" onClick={onStart}>
        <div className="absolute -inset-6 bg-gradient-to-tr from-emerald-200 to-teal-200 rounded-full blur-xl opacity-60 group-hover:opacity-100 transition-opacity duration-500"></div>
        <div className="relative bg-white p-5 rounded-2xl shadow-xl border border-emerald-50">
          <Dna size={56} className="text-emerald-600 animate-float" />
        </div>
      </div>
      
      <h1 className="text-6xl font-bold text-slate-900 mb-6 tracking-tight">
        Lumina.
      </h1>
      <p className="text-xl text-slate-500 max-w-2xl mb-10 leading-relaxed">
        The biological research platform driven by <span className="text-emerald-700 font-semibold bg-emerald-50 px-2 py-1 rounded-md border border-emerald-100">Life Intelligence</span>. 
        <br/>Seamlessly connecting literature, gene networks, and AI.
      </p>
      
      <button 
        onClick={onStart}
        className="group relative inline-flex items-center justify-center px-10 py-4 text-lg font-medium text-white transition-all duration-300 bg-slate-900 rounded-full hover:bg-emerald-900 hover:shadow-xl hover:shadow-emerald-900/20 hover:-translate-y-1"
      >
        <span>Initialize Workspace</span>
        <ArrowUpRight className="ml-2 w-5 h-5 group-hover:translate-x-1 group-hover:-translate-y-1 transition-transform" />
      </button>
    </div>
  </div>
);

// --- Sub-Views ---

const DashboardView = () => (
  <div className="relative space-y-8 animate-fade-in-up">
    {/* Background Injection */}
    <OrganicBackground type="dashboard" />
    
    {/* Content */}
    <div className="relative z-10">
      {/* Header Section */}
      <div className="flex justify-between items-end">
        <div>
          <h2 className="text-3xl font-bold text-slate-800">Bio-Research Overview</h2>
          <p className="text-slate-500 mt-2 flex items-center gap-2">
            <span className="flex h-3 w-3 relative">
              <span className="animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"></span>
              <span className="relative inline-flex rounded-full h-3 w-3 bg-emerald-500"></span>
            </span>
            System Online • Nexus Core v3.0 (Life Sciences)
          </p>
        </div>
        <div className="flex gap-3">
          <button className="px-4 py-2 bg-white/60 backdrop-blur border border-slate-200 text-slate-600 rounded-lg text-sm font-medium hover:bg-white hover:border-emerald-200 transition-all shadow-sm">
            Import FASTA/PDF
          </button>
          <button className="px-4 py-2 bg-gradient-to-r from-slate-900 to-slate-800 text-white rounded-lg text-sm font-medium hover:shadow-lg hover:shadow-slate-900/20 transition-all flex items-center gap-2">
            <Plus size={16} />
            New Experiment
          </button>
        </div>
      </div>

      {/* Stats Grid */}
      <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mt-8">
        {STATS.map((stat, idx) => (
          <StatCard key={idx} stat={stat} />
        ))}
      </div>

      {/* Recent Activity / Papers */}
      <div className="bg-white/80 backdrop-blur-md rounded-2xl border border-emerald-100/50 shadow-sm overflow-hidden mt-8">
        <div className="p-6 border-b border-emerald-50 flex justify-between items-center bg-emerald-50/30">
          <h3 className="font-bold text-lg text-slate-800 flex items-center gap-2">
            <Activity size={18} className="text-emerald-600" />
            Recent Literature
          </h3>
          <button className="text-sm text-emerald-600 hover:text-emerald-700 font-medium">View Library</button>
        </div>
        <div className="divide-y divide-emerald-50">
          {RECENT_PAPERS.map((paper) => (
            <div key={paper.id} className="p-4 hover:bg-emerald-50/50 transition-colors flex items-center justify-between group cursor-pointer">
              <div className="flex items-start gap-4">
                <div className="p-2 bg-white border border-emerald-100 text-emerald-600 rounded-lg group-hover:bg-emerald-600 group-hover:text-white transition-all duration-300">
                  <FileText size={20} />
                </div>
                <div>
                  <h4 className="text-sm font-semibold text-slate-900 group-hover:text-emerald-800 transition-colors">{paper.title}</h4>
                  <p className="text-xs text-slate-500 mt-1">{paper.authors} • <span className="italic">{paper.journal}</span></p>
                </div>
              </div>
              <div className="flex items-center gap-4">
                <span className={`text-xs px-2 py-1 rounded-md font-medium border ${
                  paper.status === 'Reading' ? 'bg-amber-50 text-amber-700 border-amber-100' :
                  paper.status === 'New' ? 'bg-emerald-50 text-emerald-700 border-emerald-100' : 'bg-slate-50 text-slate-500 border-slate-100'
                }`}>
                  {paper.status}
                </span>
                <span className="text-xs text-slate-400 w-20 text-right">{paper.added}</span>
                <button className="p-1 text-slate-300 hover:text-emerald-600 transition-colors">
                  <ChevronRight size={16} />
                </button>
              </div>
            </div>
          ))}
        </div>
      </div>
    </div>
  </div>
);

const ReaderView = () => {
  const [selectedText, setSelectedText] = useState(null);
  const [showAskTooltip, setShowAskTooltip] = useState(false);
  const [chatOpen, setChatOpen] = useState(true);

  // Mock function to simulate selecting text
  const handleTextSelect = (e) => {
    e.stopPropagation();
    setSelectedText("Cas9 is a dual-RNA-guided DNA endonuclease that uses base pairing to recognize and cleave target DNAs.");
    setShowAskTooltip(true);
  };

  return (
    <div className="flex h-full gap-6 relative">
      <OrganicBackground type="reader" />
      
      {/* PDF / Document Area */}
      <div className="flex-1 bg-white/90 backdrop-blur-sm rounded-xl border border-slate-200 shadow-sm overflow-hidden flex flex-col relative z-10 transition-all duration-300 hover:shadow-md">
        <div className="h-12 border-b border-slate-100 flex items-center px-4 justify-between bg-white/50">
          <span className="text-sm font-semibold text-slate-700 flex items-center gap-2">
            <span className="w-2 h-2 rounded-full bg-emerald-500"></span>
            CRISPR-Cas9 Gene Editing Mechanisms.pdf
          </span>
          <div className="flex gap-2 text-slate-400">
             <Search size={16} className="hover:text-emerald-600 cursor-pointer transition-colors"/>
             <DownloadCloud size={16} className="hover:text-emerald-600 cursor-pointer transition-colors"/>
          </div>
        </div>
        <div className="flex-1 p-10 overflow-y-auto font-serif text-slate-800 leading-relaxed text-lg" onClick={() => setShowAskTooltip(false)}>
           <h1 className="text-3xl font-bold mb-4 font-sans text-slate-900">Abstract</h1>
           <p className="mb-6 text-slate-600">
             The CRISPR-Cas9 system has revolutionized genomic engineering. Originating from the adaptive immune system of Streptococcus pyogenes, this mechanism allows for precise cleavage of DNA sequences.
           </p>
           <p 
             className="mb-6 p-1 hover:bg-emerald-50/80 cursor-text transition-colors rounded relative selection:bg-emerald-200"
             onClick={handleTextSelect}
           >
             Cas9 is a dual-RNA-guided DNA endonuclease that uses base pairing to recognize and cleave target DNAs. <span className="text-emerald-400 text-sm ml-2 font-sans opacity-60">[Select Text]</span>
           </p>
           <p className="mb-6 text-slate-600">
             Structural studies have revealed the distinct conformational states of Cas9 during the process of DNA interrogation and cleavage, highlighting the role of the PAM sequence in target recognition.
           </p>
           
           {/* Context Menu / Tooltip for Ask */}
           {showAskTooltip && (
             <div 
                className="absolute bg-slate-900 text-white text-sm px-4 py-2.5 rounded-lg shadow-xl cursor-pointer flex items-center gap-2 animate-bounce-short z-20 hover:bg-emerald-900 transition-colors"
                style={{ top: '220px', left: '120px' }}
                onClick={(e) => {
                  e.stopPropagation();
                  setChatOpen(true);
                }}
             >
               <Sparkles size={14} className="text-emerald-400" />
               Analyze with Lumina
             </div>
           )}
        </div>
      </div>

      {/* AI Sidebar */}
      {chatOpen && (
        <div className="w-80 flex flex-col bg-white/95 backdrop-blur rounded-xl border border-emerald-100 shadow-lg z-10 animate-fade-in">
          <div className="p-4 border-b border-emerald-50 flex justify-between items-center bg-emerald-50/30">
            <div className="flex items-center gap-2">
              <Sparkles size={16} className="text-emerald-600" />
              <span className="font-semibold text-slate-700 text-sm">Lumina Bio-AI</span>
            </div>
            <button onClick={() => setChatOpen(false)} className="text-slate-400 hover:text-slate-600">
              <X size={16} />
            </button>
          </div>
          
          <div className="flex-1 p-4 overflow-y-auto space-y-4">
            <div className="flex gap-3">
              <div className="w-8 h-8 rounded-full bg-emerald-100 flex items-center justify-center flex-shrink-0">
                <Dna size={14} className="text-emerald-600"/>
              </div>
              <div className="bg-emerald-50 p-3 rounded-2xl rounded-tl-none text-sm text-slate-700 border border-emerald-100">
                Analyzing gene sequences and protein structures in this document. How can I assist?
              </div>
            </div>
            
            {selectedText && (
               <div className="flex gap-3 flex-row-reverse">
                 <div className="bg-slate-900 p-3 rounded-2xl rounded-tr-none text-sm text-white shadow-sm">
                   Explain the enzymatic function.
                 </div>
               </div>
            )}

            {selectedText && (
               <div className="flex gap-3 animate-fade-in-up">
                 <div className="w-8 h-8 rounded-full bg-emerald-100 flex items-center justify-center flex-shrink-0">
                   <Sparkles size={14} className="text-emerald-600"/>
                 </div>
                 <div className="bg-white p-3 rounded-2xl rounded-tl-none text-sm text-slate-700 border border-emerald-100 shadow-sm">
                   Cas9 functions as molecular scissors. The "dual-RNA-guide" refers to the crRNA and tracrRNA complex that directs the protein to the specific DNA sequence.
                   <div className="mt-3 flex flex-wrap gap-2">
                     <span className="text-[10px] bg-emerald-50 text-emerald-700 px-2 py-1 rounded-full border border-emerald-100 cursor-pointer hover:bg-emerald-100">Show 3D Structure</span>
                     <span className="text-[10px] bg-emerald-50 text-emerald-700 px-2 py-1 rounded-full border border-emerald-100 cursor-pointer hover:bg-emerald-100">Find Related Papers</span>
                   </div>
                 </div>
               </div>
            )}
          </div>

          <div className="p-4 border-t border-slate-100">
             <div className="relative">
               <input 
                 type="text" 
                 placeholder="Ask about protein folding..." 
                 className="w-full pl-4 pr-10 py-2.5 bg-slate-50 border border-slate-200 rounded-lg text-sm focus:outline-none focus:border-emerald-400 focus:ring-1 focus:ring-emerald-400 transition-all"
               />
               <button className="absolute right-2 top-2 p-1 bg-emerald-600 text-white rounded hover:bg-emerald-700 transition-colors">
                 <ArrowUpRight size={14} />
               </button>
             </div>
          </div>
        </div>
      )}
    </div>
  );
}

const GraphView = () => (
  <div className="h-full bg-slate-900 rounded-2xl border border-slate-800 shadow-inner relative overflow-hidden flex items-center justify-center">
    {/* Graph-Specific Background: Synaptic Fog */}
    <div className="absolute inset-0">
      <div className="absolute top-1/4 left-1/4 w-96 h-96 bg-emerald-900/20 rounded-full blur-[100px] animate-pulse-slow"></div>
      <div className="absolute bottom-1/4 right-1/4 w-96 h-96 bg-teal-900/20 rounded-full blur-[100px] animate-pulse-slow" style={{animationDelay: '1s'}}></div>
    </div>
    
    <div className="absolute top-4 left-4 z-10 bg-slate-800/90 backdrop-blur border border-slate-700 p-2 rounded-lg text-xs font-medium text-slate-300">
      <div className="flex items-center gap-2 mb-1"><span className="w-2 h-2 rounded-full bg-emerald-500 shadow-[0_0_10px_#10b981]"></span> Target Protein</div>
      <div className="flex items-center gap-2"><span className="w-2 h-2 rounded-full bg-slate-500"></span> Related Gene</div>
    </div>
    
    <svg width="100%" height="100%" viewBox="0 0 800 600" className="z-10 relative">
      <defs>
        <pattern id="grid-dark" width="40" height="40" patternUnits="userSpaceOnUse">
          <circle cx="1" cy="1" r="1" fill="#1e293b" />
        </pattern>
        <filter id="glow">
          <feGaussianBlur stdDeviation="2.5" result="coloredBlur"/>
          <feMerge>
            <feMergeNode in="coloredBlur"/>
            <feMergeNode in="SourceGraphic"/>
          </feMerge>
        </filter>
      </defs>
      <rect width="100%" height="100%" fill="url(#grid-dark)" />
      
      {/* Edges */}
      <g stroke="#334155" strokeWidth="1">
        <line x1="400" y1="300" x2="250" y2="150" className="animate-pulse-slow"/>
        <line x1="400" y1="300" x2="550" y2="150" />
        <line x1="400" y1="300" x2="250" y2="450" />
        <line x1="400" y1="300" x2="550" y2="450" />
        <line x1="400" y1="300" x2="600" y2="300" />
        <line x1="250" y1="150" x2="150" y2="100" />
        <line x1="550" y1="150" x2="650" y2="100" />
      </g>
      
      {/* Nodes */}
      {/* Central Node */}
      <g filter="url(#glow)">
        <circle cx="400" cy="300" r="30" fill="#064e3b" stroke="#10b981" strokeWidth="2" className="animate-pulse-slow" />
        <circle cx="400" cy="300" r="10" fill="#10b981" />
      </g>
      
      {/* Satellite Nodes */}
      {[
        {cx:250, cy:150}, {cx:550, cy:150}, 
        {cx:250, cy:450}, {cx:550, cy:450}, {cx:600, cy:300}
      ].map((pos, i) => (
        <circle key={i} cx={pos.cx} cy={pos.cy} r="12" fill="#1e293b" stroke="#64748b" strokeWidth="2" className="hover:fill-emerald-900 hover:stroke-emerald-500 transition-all duration-300 cursor-pointer" />
      ))}
      
      {/* Text Labels */}
      <text x="400" y="355" textAnchor="middle" className="text-sm fill-emerald-400 font-semibold tracking-wide" style={{fontSize: '12px'}}>Cas9 Enzyme</text>
    </svg>

    <div className="absolute bottom-6 right-6 bg-emerald-600 text-white px-4 py-2 rounded-lg text-sm font-medium shadow-lg hover:bg-emerald-500 cursor-pointer flex items-center gap-2 transition-all hover:scale-105">
      <DownloadCloud size={16} />
      Export Dataset
    </div>
  </div>
);

// --- Main App Component ---

const LuminaApp = () => {
  const [hasStarted, setHasStarted] = useState(false);
  const [activeTab, setActiveTab] = useState('dashboard');
  const [searchFocused, setSearchFocused] = useState(false);

  useEffect(() => {
    // Auth check simulation
  }, []);

  if (!hasStarted) {
    return <WelcomeScreen onStart={() => setHasStarted(true)} />;
  }

  return (
    <div className="flex h-screen w-full bg-[#f8fafc] font-sans text-slate-900 overflow-hidden selection:bg-emerald-200 selection:text-emerald-900">
      
      {/* Left Navbar */}
      <div className="w-16 h-full bg-white border-r border-slate-200 flex flex-col items-center py-6 z-30 shadow-[4px_0_24px_-12px_rgba(16,185,129,0.1)]">
        {/* Logo Icon */}
        <div className="mb-8 p-2 bg-gradient-to-br from-slate-900 to-slate-800 text-white rounded-xl shadow-lg shadow-emerald-900/20 ring-1 ring-white/20">
          <BookOpen size={20} />
        </div>

        {/* Navigation */}
        <div className="flex-1 flex flex-col w-full px-2 gap-2">
          <SidebarItem 
            icon={LayoutGrid} 
            active={activeTab === 'dashboard'} 
            onClick={() => setActiveTab('dashboard')} 
          />
          <SidebarItem 
            icon={FileText} 
            active={activeTab === 'reader'} 
            onClick={() => setActiveTab('reader')} 
          />
          <SidebarItem 
            icon={Network} 
            active={activeTab === 'graph'} 
            onClick={() => setActiveTab('graph')} 
          />
        </div>

        <div className="mb-4 w-full px-2 gap-2 flex flex-col">
           <SidebarItem icon={Settings} active={false} onClick={() => {}} />
           <div className="w-full h-[1px] bg-slate-100 my-2"></div>
           <div className="w-10 h-10 rounded-full bg-slate-50 flex items-center justify-center text-slate-400 hover:text-emerald-600 hover:bg-emerald-50 cursor-pointer transition-colors">
              <User size={18} />
           </div>
        </div>
      </div>

      {/* Main Content Area */}
      <div className="flex-1 flex flex-col h-full overflow-hidden relative">
        
        {/* Top Bar */}
        <header className="h-16 bg-white/80 backdrop-blur-md border-b border-slate-200 flex items-center justify-between px-8 z-20 shrink-0 sticky top-0">
          <div className="flex items-center gap-2 text-sm text-slate-500 select-none drag-region">
            <span className="font-bold text-slate-800 tracking-tight">Lumina</span>
            <span className="text-slate-300">/</span>
            <span className="capitalize text-slate-600">{activeTab}</span>
          </div>

          <div className={`transition-all duration-300 ${searchFocused ? 'w-96' : 'w-64'} relative group`}>
            <Search className="absolute left-3 top-2.5 text-slate-400 group-focus-within:text-emerald-500 transition-colors" size={18} />
            <div className="absolute right-3 top-2.5 flex gap-1">
               <span className="text-[10px] font-mono bg-slate-100 text-slate-400 px-1.5 py-0.5 rounded border border-slate-200">⌘K</span>
            </div>
            <input 
              type="text" 
              placeholder="Search DNA, proteins, papers..." 
              className="w-full bg-slate-50/50 border border-slate-200 text-slate-800 text-sm rounded-lg pl-10 pr-12 py-2 focus:outline-none focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 transition-all placeholder:text-slate-400"
              onFocus={() => setSearchFocused(true)}
              onBlur={() => setSearchFocused(false)}
            />
          </div>

          <div className="flex items-center gap-4">
            <button className="relative p-2 text-slate-400 hover:text-emerald-600 transition-colors">
              <Bell size={20} />
              <span className="absolute top-2 right-2 w-2 h-2 bg-emerald-500 rounded-full border-2 border-white shadow-sm"></span>
            </button>
            <div className="text-right hidden lg:block">
              <div className="text-xs font-bold text-slate-800">Dr. Chen</div>
              <div className="text-[10px] text-emerald-600 font-medium tracking-wide">Genomics Lead</div>
            </div>
          </div>
        </header>

        {/* Content Wrapper */}
        <main className="flex-1 p-6 overflow-y-auto overflow-x-hidden relative">
          {activeTab === 'dashboard' && <DashboardView />}
          {activeTab === 'reader' && <ReaderView />}
          {activeTab === 'graph' && <GraphView />}
        </main>

      </div>
      
      <style jsx global>{`
        .drag-region {
          -webkit-app-region: drag;
        }
        button, input {
          -webkit-app-region: no-drag;
        }
        @keyframes float {
          0% { transform: translate(0, 0); }
          50% { transform: translate(0, -10px); }
          100% { transform: translate(0, 0); }
        }
        @keyframes float-slow {
          0% { transform: translate(0, 0) rotate(0deg); }
          50% { transform: translate(10px, -15px) rotate(2deg); }
          100% { transform: translate(0, 0) rotate(0deg); }
        }
        @keyframes float-reverse {
          0% { transform: translate(0, 0) rotate(0deg); }
          50% { transform: translate(-10px, 15px) rotate(-2deg); }
          100% { transform: translate(0, 0) rotate(0deg); }
        }
        @keyframes pulse-slow {
          0%, 100% { opacity: 0.4; transform: scale(1); }
          50% { opacity: 0.6; transform: scale(1.05); }
        }
        @keyframes dash {
          to {
            stroke-dashoffset: -1000;
          }
        }
        .animate-float { animation: float 3s ease-in-out infinite; }
        .animate-float-slow { animation: float-slow 8s ease-in-out infinite; }
        .animate-float-reverse { animation: float-reverse 10s ease-in-out infinite; }
        .animate-pulse-slow { animation: pulse-slow 4s ease-in-out infinite; }
        .animate-dash { stroke-dasharray: 10; animation: dash 20s linear infinite; }
        
        /* Typography Polish */
        h1, h2, h3 { letter-spacing: -0.025em; }
        
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #d1fae5; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #10b981; }
      `}</style>
    </div>
  );
};

export default LuminaApp;